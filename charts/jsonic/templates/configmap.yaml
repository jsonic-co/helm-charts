apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "jsonic.fullname" . }}
  namespace: {{ include "jsonic.namespace" . | quote }}
  labels:
    app.kubernetes.io/component: jsonic
    {{- include "jsonic.labels" . | nindent 4 }}
  {{- if .Values.commonAnnotations }}
  annotations:
    {{- toYaml .Values.commonAnnotations | nindent 4 }}
  {{- end }}
data:
  ACCESS_TOKEN_VALIDITY: {{ .Values.jsonic.backend.authToken.accessTokenValidity | quote }}
  ALLOW_AUDIT_LOGS: {{ .Values.jsonic.backend.clickhouse.allowAuditLogs | quote }}
  ALLOW_SECURE_COOKIES: {{ .Values.jsonic.backend.allowSecureCookies | quote }}
  CLICKHOUSE_HOST: {{ include "jsonic.secret.clickhouseHost" . | quote }}
  {{- if eq .Values.deploymentMode "aio" }}
  ENABLE_SUBPATH_BASED_ACCESS: {{ .Values.jsonic.frontend.enableSubpathBasedAccess | quote }}
  {{- else }}
  ENABLE_SUBPATH_BASED_ACCESS: "false"
  {{- end }}
  GITHUB_AUTHORIZATION_URL: {{ .Values.jsonic.backend.auth.githubEnterprise.authorizationUrl | quote }}
  GITHUB_CALLBACK_URL: {{ include "jsonic.backend.githubCallbackUrl" . | quote }}
  GITHUB_SCOPE: {{ .Values.jsonic.backend.auth.github.scope | join "," | quote }}
  GITHUB_TOKEN_URL: {{ .Values.jsonic.backend.auth.githubEnterprise.tokenUrl | quote }}
  GITHUB_USER_EMAIL_URL: {{ .Values.jsonic.backend.auth.githubEnterprise.userEmailUrl | quote }}
  GITHUB_USER_PROFILE_URL: {{ .Values.jsonic.backend.auth.githubEnterprise.userProfileUrl | quote }}
  GOOGLE_CALLBACK_URL: {{ include "jsonic.backend.googleCallbackUrl" . | quote }}
  GOOGLE_SCOPE: {{ .Values.jsonic.backend.auth.google.scope | join "," | quote }}
  JSONIC_AIO_ALTERNATE_PORT: {{ .Values.jsonic.backend.aioAlternatePort | quote }}
  HORIZONTAL_SCALING: {{ .Values.jsonic.backend.horizontalScalingEnabled | quote }}
  IS_GITHUB_ENTERPRISE_ENABLED: {{ .Values.jsonic.backend.auth.githubEnterprise.enabled | quote }}
  LOCAL_PROXY_SERVER_ENABLE: {{ .Values.jsonic.frontend.localProxyServerEnabled | quote }}
  MAGIC_LINK_TOKEN_VALIDITY: {{ .Values.jsonic.backend.authToken.magicLinkTokenValidity | quote }}
  MAILER_ADDRESS_FROM: {{ .Values.jsonic.backend.mailer.addressFrom | quote }}
  MAILER_SMTP_ENABLE: {{ .Values.jsonic.backend.mailer.smtpEnabled | quote }}
  MAILER_SMTP_HOST: {{ .Values.jsonic.backend.mailer.smtpHost | quote }}
  MAILER_SMTP_PORT: {{ .Values.jsonic.backend.mailer.smtpPort | quote }}
  MAILER_SMTP_SECURE: {{ .Values.jsonic.backend.mailer.smtpSecure | quote }}
  MAILER_TLS_REJECT_UNAUTHORIZED: {{ .Values.jsonic.backend.mailer.tlsRejectUnauthorized | quote }}
  MAILER_USE_CUSTOM_CONFIGS: {{ .Values.jsonic.backend.mailer.useCustomConfigs | quote }}
  MICROSOFT_CALLBACK_URL: {{ include "jsonic.backend.microsoftCallbackUrl" . | quote }}
  MICROSOFT_SCOPE: {{ .Values.jsonic.backend.auth.microsoft.scope | join "," | quote }}
  MICROSOFT_TENANT: {{ .Values.jsonic.backend.auth.microsoft.tenant | quote }}
  OIDC_AUTH_URL: {{ .Values.jsonic.backend.auth.oidc.authorizationUrl | quote }}
  OIDC_CALLBACK_URL: {{ include "jsonic.backend.oidcCallbackUrl" . | quote }}
  OIDC_ISSUER: {{  .Values.jsonic.backend.auth.oidc.issuer | quote }}
  OIDC_PROVIDER_NAME: {{  .Values.jsonic.backend.auth.oidc.providerName | quote }}
  OIDC_SCOPE: {{ .Values.jsonic.backend.auth.oidc.scope | join " " | quote }}
  OIDC_TOKEN_URL: {{ .Values.jsonic.backend.auth.oidc.tokenUrl | quote }}
  OIDC_USER_INFO_URL: {{ .Values.jsonic.backend.auth.oidc.userInfoUrl | quote }}
  PROXY_APP_URL: {{ .Values.jsonic.frontend.proxyAppUrl | quote }}
  RATE_LIMIT_TTL: {{ .Values.jsonic.backend.rateLimit.ttl | quote }}
  RATE_LIMIT_MAX: {{ .Values.jsonic.backend.rateLimit.max | quote }}
  REDIRECT_URL: {{ include "jsonic.backend.redirectUrl" . | quote }}
  REFRESH_TOKEN_VALIDITY: {{ .Values.jsonic.backend.authToken.refreshTokenValidity | quote }}
  SAML_AUDIENCE: {{ .Values.jsonic.backend.auth.saml.audience | quote }}
  SAML_CALLBACK_URL: {{ include "jsonic.backend.samlCallbackUrl" . | quote }}
  SAML_CERT: {{ .Values.jsonic.backend.auth.saml.cert | quote }}
  SAML_ENTRY_POINT: {{ .Values.jsonic.backend.auth.saml.entryPoint | quote }}
  SAML_ISSUER: {{ .Values.jsonic.backend.auth.saml.issuer | quote }}
  SAML_WANT_ASSERTIONS_SIGNED: {{ .Values.jsonic.backend.auth.saml.wantAssertionsSigned | quote }}
  SAML_WANT_RESPONSE_SIGNED: {{ .Values.jsonic.backend.auth.saml.wantResponseSigned | quote }}
  TOKEN_SALT_COMPLEXITY: {{ .Values.jsonic.backend.authToken.tokenSaltComplexity | quote }}
  VITE_ADMIN_URL: {{ include "jsonic.frontend.adminUrl" . | quote }}
  VITE_ALLOWED_AUTH_PROVIDERS: {{ .Values.jsonic.backend.auth.allowedProviders | join "," | upper | quote }}
  VITE_APP_PRIVACY_POLICY_LINK: {{ .Values.jsonic.frontend.appPrivacyPolicyLink | quote }}
  VITE_APP_TOS_LINK: {{ .Values.jsonic.frontend.appTosLink | quote }}
  VITE_BACKEND_API_URL: {{ include "jsonic.frontend.backendApiUrl" . | quote }}
  VITE_BACKEND_GQL_URL: {{ include "jsonic.frontend.backendGqlUrl" . | quote }}
  VITE_BACKEND_WS_URL: {{ include "jsonic.frontend.backendWsUrl" . | quote }}
  VITE_BASE_URL: {{ include "jsonic.frontend.baseUrl" . | quote }}
  VITE_SHORTCODE_BASE_URL: {{ include "jsonic.frontend.shortcodeBaseUrl" . | quote }}
  WHITELISTED_ORIGINS: {{ include "jsonic.backend.whitelistedOrigins" . | quote }}
